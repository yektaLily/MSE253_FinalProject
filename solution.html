<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yekta Amirkhalili">
<meta name="dcterms.date" content="2025-07-15">

<title>PR2-Solution</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="solution_files/libs/clipboard/clipboard.min.js"></script>
<script src="solution_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="solution_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="solution_files/libs/quarto-html/popper.min.js"></script>
<script src="solution_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="solution_files/libs/quarto-html/anchor.min.js"></script>
<link href="solution_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="solution_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="solution_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="solution_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="solution_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul class="collapse">
  <li><a href="#mini-project-1-hypothesis-testing-30p" id="toc-mini-project-1-hypothesis-testing-30p" class="nav-link active" data-scroll-target="#mini-project-1-hypothesis-testing-30p"><span class="header-section-number">1</span> Mini-Project 1: Hypothesis Testing [30p]</a></li>
  <li><a href="#mini-project-2-30p" id="toc-mini-project-2-30p" class="nav-link" data-scroll-target="#mini-project-2-30p"><span class="header-section-number">2</span> Mini-Project 2 [30p]</a></li>
  <li><a href="#mini-project-3-linear-regression-analysis-40p" id="toc-mini-project-3-linear-regression-analysis-40p" class="nav-link" data-scroll-target="#mini-project-3-linear-regression-analysis-40p"><span class="header-section-number">3</span> Mini-Project 3: Linear Regression Analysis [40p]</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">PR2-Solution</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yekta Amirkhalili </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 15, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<style>
.quarto-title h1.title {
  font-size: 1.5rem; 
}

h2{
    font-size: 1.2rem;
    background-color:rgba(128, 170, 156, 0.48);
}

.future-idea-box {
  border: 2px solid var(--quarto-hl-header-color, #86bdab); /* Uses Quarto header color variable or fallback */
  border-radius: 8px;
  padding: 1em;
  margin: 1em 0;
  background: #f9f9fc;
}
.future-idea-title {
  font-weight: bold;
  color: var(--quarto-hl-header-color,rgb(111, 172, 152));
  margin-bottom: 0.5em;
  font-size: 1.1em;
}

.blue-text {
  color: rgba(70, 70, 194, 1);
}

</style>
<!-- CSS CHANGES -->
<p>All text in blue is written by intructor as the answer/explanation to the question.</p>
<section id="mini-project-1-hypothesis-testing-30p" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="mini-project-1-hypothesis-testing-30p"><span class="header-section-number">1</span> Mini-Project 1: Hypothesis Testing [30p]</h2>
<p>The following R libraries are used:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="proportion-test" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="proportion-test"><span class="header-section-number">1.1</span> Proportion Test</h3>
<p>A survey finds that 60% of users prefer using mobile apps over desktop websites for booking appointments. Your company believes the proportion is different in your city. Use the <code>PRJ2_MP1_PT.csv</code> dataset to test whether the local preference differs from the national figure.</p>
<div class="blue-text">
<p>I will use a one-sample z-test for proportions to test the hypothesis.</p>
<p>Summarizing question’s information:</p>
<ul>
<li>proportion of users who prefer apps over desktop websites is 60/100.</li>
<li>I have data from my city.</li>
<li>Is the proportion I have in my city different from the 60% national figure?</li>
</ul>
<p>Mathamtically, that is:</p>
<p><span class="math display">\[
H_0: p = 0.6
\]</span> vs <span class="math display">\[
H_a: p \neq 0.6
\]</span> Where <span class="math inline">\(p\)</span> is the proportion of users in my city who prefer apps over desktop websites. Since significance level is not given, I will use the default of 0.05. The test statistic is calculated as follows: <span class="math display">\[
z = \frac{\hat{p} - p_0}{\sqrt{\frac{p_0(1 - p_0)}{n}}}
\]</span> where <span class="math inline">\(\hat{p}\)</span> is the sample proportion, <span class="math inline">\(p_0\)</span> is the population proportion, and <span class="math inline">\(n\)</span> is the sample size. The critical region for a two-tailed test at the 0.05 significance level is <span class="math inline">\(|z| &gt; z_{\alpha/2} = 1.96\)</span>. Chapter 10, Example 10.9 and 10.10 would be helpful.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/PRJ2_MP1_PT.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  USER_ID Preference 
    &lt;dbl&gt; &lt;chr&gt;      
1       1 Mobile App 
2       2 Desktop App
3       3 Mobile App 
4       4 Desktop App
5       5 Desktop App
6       6 Mobile App </code></pre>
</div>
</div>
<div class="blue-text">
<p>Let’s summarize the data to see how many of each we have:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Preference) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Preference) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   Preference [2]
  Preference      n
  &lt;chr&gt;       &lt;int&gt;
1 Mobile App    782
2 Desktop App   718</code></pre>
</div>
</div>
<div class="blue-text">
<p>Add proportion to this:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Preference) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Preference) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  Preference      n Proportion
  &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt;
1 Mobile App    782      0.521
2 Desktop App   718      0.479</code></pre>
</div>
</div>
<div class="blue-text">
<p>Already looks kind of close to 60%, but also not really depending on who you ask (52%) - so which is it? You can either calculate the z value and compare it to the critical value, or use the <code>prop.test</code> function in R. This test takes in the number of successes (in this case, the number of users who prefer mobile apps), the total number of observations, the hypothesized proportion, and the alternative hypothesis’s one tailed or two-tailedness.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">sum</span>(df1<span class="sc">$</span>Preference <span class="sc">==</span> <span class="st">"Mobile App"</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">nrow</span>(df1),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fl">0.60</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">correct =</span> <span class="cn">FALSE</span> <span class="co"># optional </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test without continuity correction

data:  sum(df1$Preference == "Mobile App") out of nrow(df1), null probability 0.6
X-squared = 38.678, df = 1, p-value = 4.999e-10
alternative hypothesis: true p is not equal to 0.6
95 percent confidence interval:
 0.4960311 0.5465266
sample estimates:
        p 
0.5213333 </code></pre>
</div>
</div>
<div class="blue-text">
<p>The p-value is quite small, so we reject the null hypothesis. The null hypothesis was that the proportion of users who prefer mobile apps is 60%, and we found that it is significantly different from this value. The 95% confidence interval for the proportion of users who prefer mobile apps is (0.42, 0.54), which does not include 0.6.</p>
</div>
</section>
<section id="difference-in-means" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="difference-in-means"><span class="header-section-number">1.2</span> Difference in Means</h3>
<p>Two customer service strategies were implemented in your company. The customer satisfaction scores are collected and saved in <code>PRJ2_MP1_DM.csv</code>. Test whether the mean satisfaction differs significantly between the two strategies.</p>
<div class="blue-text">
<p>I will use a two-sample t-test to test the difference in means between the two customer service strategies. The hypotheses are as follows: <span class="math display">\[
H_0: \mu_1 - \mu_2 = 0
\]</span> vs <span class="math display">\[
H_a: \mu_1 - \mu_2 \neq 0
\]</span> Where <span class="math inline">\(\mu_1\)</span> is the mean satisfaction score for strategy 1 and <span class="math inline">\(\mu_2\)</span> is the mean satisfaction score for strategy 2. The significance level is not given, so I will use the default of 0.05. The test statistic is calculated based on chapter 10.5 of Walpole book.</p>
</div>
<div class="blue-text">
<p>Let’s first look at the data and see the difference between the two strategies.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/PRJ2_MP1_DM.csv"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,500
Columns: 3
$ ...1      &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…
$ strategy1 &lt;dbl&gt; 58.533, 56.791, 59.118, 52.179, 59.108, 51.463, 56.945, 58.4…
$ strategy2 &lt;dbl&gt; 88.491, 89.114, 89.632, 74.994, 89.769, 90.928, 93.512, 95.8…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">stg1_mean =</span> <span class="fu">mean</span>(strategy1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">stg2_mean =</span> <span class="fu">mean</span>(strategy2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  stg1_mean stg2_mean
      &lt;dbl&gt;     &lt;dbl&gt;
1      57.0      88.0</code></pre>
</div>
</div>
<div class="blue-text">
<p>It seems that the mean satisfaction score for strategy 1 is much lower than for strategy 2. But, is it significantly different? Let’s see the tests for the cases where:</p>
<ul>
<li>Variances are known or unknown and equal</li>
<li>Variances are unknown and unequal</li>
</ul>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variances are known or unknown and equal</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df2<span class="sc">$</span>strategy1, df2<span class="sc">$</span>strategy2, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  df2$strategy1 and df2$strategy2
t = -203.88, df = 2998, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -31.30966 -30.71318
sample estimates:
mean of x mean of y 
 56.97268  87.98410 </code></pre>
</div>
</div>
<div class="blue-text">
<p>Since the p-value is less than 0.05, we reject the null hypothesis and conclude that there is a significant difference in mean satisfaction scores between the two strategies. That is, <span class="math inline">\(\mu_1 - \mu_2 \neq 0\)</span>.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variances are unknown and unequal</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df2<span class="sc">$</span>strategy1, df2<span class="sc">$</span>strategy2, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  df2$strategy1 and df2$strategy2
t = -203.88, df = 2433, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -31.30969 -30.71315
sample estimates:
mean of x mean of y 
 56.97268  87.98410 </code></pre>
</div>
</div>
<div class="blue-text">
<p>Similarly, if variances were unknown and unequal, we would still reject the null hypothesis. Let’s see if we can say something about the variances:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(df2<span class="sc">$</span>strategy1, df2<span class="sc">$</span>strategy2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  df2$strategy1 and df2$strategy2
F = 0.3496, num df = 1499, denom df = 1499, p-value &lt; 2.2e-16
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.3159246 0.3868637
sample estimates:
ratio of variances 
         0.3495994 </code></pre>
</div>
</div>
<div class="blue-text">
<p>Looks like variances are not equal, so we should use the second t-test result. Another way to check means (and variance) between the two groups is using visualizations (but much less formal):</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(strategy1, strategy2), </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"strategyName"</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"strategySatisfaction"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>strategyName, <span class="at">y=</span>strategySatisfaction)) <span class="sc">+</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Strategy"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Satisfaction"</span>) <span class="sc">+</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solution_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="variance-test" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="variance-test"><span class="header-section-number">1.3</span> Variance Test</h3>
<p>You are analyzing consistency in delivery times between two delivery partners. The dataset is available in <code>PRJ2_MP1_VT.csv</code>. Test whether their delivery time variances are equal.</p>
<div class="blue-text">
<p>All tests are based on Walpole’s book, chapter 10.10. We want to test the following hypotheses: <span class="math display">\[
H_0: \sigma_1^2 = \sigma_2^2
\]</span><br>
vs <span class="math display">\[
H_a: \sigma_1^2 \neq \sigma_2^2
\]</span> Where <span class="math inline">\(\sigma_1^2\)</span> is the variance of delivery times for partner 1 and <span class="math inline">\(\sigma_2^2\)</span> is the variance for partner 2.<br>
We do have to assume the two samples are independent. Since the significance level is not given, I will use the default of 0.05. Look at example 10.13 for more details. Let’s look at the data first and check the variances:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/PRJ2_MP1_VT.csv"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 200
Columns: 3
$ ...1          &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
$ delivery_time &lt;dbl&gt; 27.19762, 28.84911, 37.79354, 30.35254, 30.64644, 38.575…
$ partner       &lt;chr&gt; "Partner1", "Partner1", "Partner1", "Partner1", "Partner…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(partner) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">variance =</span> <span class="fu">var</span>(delivery_time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  partner  variance
  &lt;chr&gt;       &lt;dbl&gt;
1 Partner1     20.8
2 Partner2     45.8</code></pre>
</div>
</div>
<div class="blue-text">
<p>So, we need to separate the data by partner and then use the <code>var.test</code> function to test the variances.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>partner1 <span class="ot">&lt;-</span> df3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(partner <span class="sc">==</span> <span class="st">"Partner1"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(delivery_time)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>partner2 <span class="ot">&lt;-</span> df3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(partner <span class="sc">==</span> <span class="st">"Partner2"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(delivery_time)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(partner1, partner2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  partner1 and partner2
F = 0.45464, num df = 99, denom df = 99, p-value = 0.0001121
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.305902 0.675704
sample estimates:
ratio of variances 
         0.4546418 </code></pre>
</div>
</div>
<div class="blue-text">
<p>The null hypothesis is that the variances are equal, and the alternative hypothesis is that they are not equal. The p-value is 0.0001, which is less than the significance level of 0.05. Therefore, we reject the null hypothesis and conclude that the variances of delivery times between the two partners are significantly different. This means that one partner is more consistent than the other.</p>
</div>
<hr>
</section>
</section>
<section id="mini-project-2-30p" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="mini-project-2-30p"><span class="header-section-number">2</span> Mini-Project 2 [30p]</h2>
<p>You work for a coffee company as a data scientist. The company wants to find out which roasting level leads to the highest average rating from customers. You conduct taste tests and collect scores from 50 random customers for each roast level. The results of this is collected in the <code>PRJ2_MP2.csv</code> file. Write clearly the statistical question you want to answer, your methodology in answering the question and your results. If you find that there are differences between roast levels, determine which groups differ. Finally, complete your analysis by discussing what the findings mean practically and what you suggest to your company to do next.</p>
<div class="blue-text">
<p>The statistical question we want to answer is: “Which roasting level leads to the highest average rating from customers?” We will use ANOVA to test whether there are significant differences in ratings between the different roast levels. The null hypothesis is that there are no differences in ratings between the roast levels, while the alternative hypothesis is that at least one roast level has a different mean rating. We will use a significance level of 0.05. If we find significant differences, we will use post-hoc tests to determine which roast levels differ from each other. Finally, we will interpret the results and provide practical recommendations to the company.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/PRJ2_MP2.csv"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 2
$ Roast &lt;chr&gt; "Light", "Light", "Light", "Light", "Light", "Light", "Light", "…
$ Score &lt;dbl&gt; 7.19, 6.22, 6.68, 6.82, 6.70, 6.45, 7.26, 6.45, 7.51, 6.47, 7.15…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df4 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Roast) <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean_rating =</span> <span class="fu">mean</span>(Score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  Roast  mean_rating
  &lt;chr&gt;        &lt;dbl&gt;
1 Dark          3.92
2 Light         6.48
3 Medium        8.55</code></pre>
</div>
</div>
<div class="blue-text">
<p>Looks like medium has the highest mean rating, but we need to test if this is statistically significant.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Score <span class="sc">~</span> <span class="fu">as.factor</span>(Roast), <span class="at">data =</span> df4)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Df Sum Sq Mean Sq F value Pr(&gt;F)    
as.factor(Roast)   2  537.0  268.50    1058 &lt;2e-16 ***
Residuals        147   37.3    0.25                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="blue-text">
<p>There is a difference in means between the roast levels, as the p-value is less than 0.05. Therefore, we know that roast level matters! Now, we need to perform post-hoc tests to determine which roast levels differ from each other. We will use Tukey’s HSD test for this purpose.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>tukey_result    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Score ~ as.factor(Roast), data = df4)

$`as.factor(Roast)`
               diff      lwr      upr p adj
Light-Dark   2.5582 2.319658 2.796742     0
Medium-Dark  4.6260 4.387458 4.864542     0
Medium-Light 2.0678 1.829258 2.306342     0</code></pre>
</div>
</div>
<div class="blue-text">
<p>Another way to do this:</p>
<ul>
<li>Separate the data by roast level and create the covariates (go to your notes and see Indicator variables) <span class="math display">\[
y = \mu + \tau_1 (I(L) - I(D)) + \tau_2 (I(M) - I(D)) + \epsilon
\]</span></li>
<li>Make pairwise comparisons between the roast levels, creating a new value from the other two (factor levels)</li>
<li>Use a linear model</li>
<li>Use tukey’s and bonferroni</li>
</ul>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df4<span class="sc">$</span>Roast <span class="ot">&lt;-</span> <span class="fu">factor</span>(df4<span class="sc">$</span>Roast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Dark"</span>, <span class="st">"Light"</span>, <span class="st">"Medium"</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up custom contrasts: </span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># First column: Light vs Dark</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Second column: Medium vs Dark</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df4<span class="sc">$</span>Roast) <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">1</span>,  <span class="dv">0</span>,  <span class="co"># Dark</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="co"># Light</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>     <span class="dv">0</span>,  <span class="dv">1</span>   <span class="co"># Medium</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(df4<span class="sc">$</span>Roast)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Light_vs_Dark"</span>, <span class="st">"Medium_vs_Dark"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>contrast_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Score <span class="sc">~</span> Roast, <span class="at">data =</span> df4)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Score ~ Roast, data = df4)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5502 -0.2883  0.0028  0.2873  1.4258 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          6.48240    0.07124   90.99  &lt; 2e-16 ***
RoastLight_vs_Dark   2.55820    0.10075   25.39  &lt; 2e-16 ***
RoastMedium_vs_Dark -0.49040    0.17450   -2.81  0.00562 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5037 on 147 degrees of freedom
Multiple R-squared:  0.935, Adjusted R-squared:  0.9342 
F-statistic:  1058 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="blue-text">
<p>From the results, we have: <span class="math inline">\(\mu = 6.482\)</span>, <span class="math inline">\(\tau_1 = 2.558\)</span>, and <span class="math inline">\(\tau_2 = -0.490\)</span>. We need to calculate the t-statistic: <span class="math display">\[
t = \frac{\hat{\tau}_i - \hat{\tau}_j}{\sqrt{2\frac{\sigma^2}{n}}}
\]</span> Critical values for multiple comparisons:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sigma_sq <span class="ot">&lt;-</span> <span class="fl">0.5037</span> <span class="co"># from contrast_model summary </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>denom <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> sigma_sq <span class="sc">/</span> <span class="dv">50</span>) <span class="co"># 50 is the number of observations per group</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>tau_light_vs_medium <span class="ot">&lt;-</span> <span class="sc">-</span>(<span class="fl">2.55820</span> <span class="sc">-</span> <span class="fl">0.49040</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>t_light_vs_dark <span class="ot">&lt;-</span> (<span class="fl">2.55820</span>) <span class="sc">/</span> denom</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>t_medium_vs_dark <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fl">0.49040</span>) <span class="sc">/</span> denom</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>t_light_vs_medium <span class="ot">&lt;-</span> tau_light_vs_medium <span class="sc">/</span> denom </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="blue-text">
<p>Now compare these with bonferroni and tukey’s critical values:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni critical value</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>bonferroni_critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">147</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 147 is the number of observations - 3 (number of groups)</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey's critical value</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>tukey_critical <span class="ot">&lt;-</span> <span class="fu">qtukey</span>(<span class="fl">0.95</span>, <span class="dv">3</span>, <span class="dv">147</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"bonferonni"</span>, <span class="fu">round</span>(bonferroni_critical,<span class="dv">3</span>), <span class="st">" Tukey"</span>, <span class="fu">round</span>(tukey_critical,<span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "bonferonni 2.148  Tukey 2.368"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(t_light_vs_dark <span class="sc">&gt;</span> bonferroni_critical, <span class="st">"and "</span>, t_light_vs_dark <span class="sc">&gt;</span> tukey_critical))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "TRUE and  TRUE"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(t_medium_vs_dark <span class="sc">&gt;</span> bonferroni_critical, <span class="st">"and "</span>, t_medium_vs_dark <span class="sc">&gt;</span> tukey_critical))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FALSE and  FALSE"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(t_light_vs_medium <span class="sc">&gt;</span> bonferroni_critical,<span class="st">"and "</span>, t_light_vs_medium <span class="sc">&gt;</span> tukey_critical))    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FALSE and  FALSE"</code></pre>
</div>
</div>
<div class="blue-text">
<p>Since if <span class="math inline">\(t_{ij} &gt; t_{crit}\)</span>, then we can reject the null hypothesis that the two means are equal. Therefore, only ones different are light vs dark. So, <span class="math inline">\(\mu_{light} \neq \mu_{dark}\)</span>. Since these two groups are different, maybe the company should focus on improving the dark roast to match the light roast’s quality so the dark roast rating isn’t so low.</p>
</div>
</section>
<section id="mini-project-3-linear-regression-analysis-40p" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="mini-project-3-linear-regression-analysis-40p"><span class="header-section-number">3</span> Mini-Project 3: Linear Regression Analysis [40p]</h2>
<p>Download the <code>PRJ2_MP3_airbnb.csv</code> dataset either from LEARN or from <a href="https://www.kaggle.com/datasets/aroramahima1/amsterdam-airbnb-prices-dataset/data">Kaggle</a>. This dataset has 33 columns and <span class="math inline">\(7,833\)</span> rows of Airbnb listings from Amsterdam. Use this dataset to predict the price of Airbnb listings in Amsterdam using linear regression. Make sure you clean and pre-process the dataset, include exploratory data analysis, check regression assumptions, and set aside 20% of the dataset as your test data. You do not need to include all the variables (columns) in the model, but your final prediction accuracy (as long as overfitting is not an issue) will be graded. Include a correlation matrix with the model variables before you do the modeling.</p>
<p>Make sure you can justify any variable that is included in your model (using literature or data). Check for multi-collinearity and normality of residuals. Most importantly, interpret the regression results: Which predictors are significant? What does the coefficient of each mean in real-world terms? How good is your model? Be sure to explain your findings in simple, real-world terms. For example: ``Each additional bedroom increases the price by $85 on average, holding other variables constant.’’ Write your regression model’s mathematical formula and introduce the notation in a Table.</p>

<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb46" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "PR2-Solution"</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Yekta Amirkhalili"</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "today"</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Table of Contents"</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 6</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 4</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co">    math:</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">      engine: mathjax</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co">    self-contained: false</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="co">    execute:</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="co">      eval: true </span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co">      echo: true</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co">      warning: false</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co">      message: false</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co">      error: false</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co">      results: 'asis'</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="fu">.quarto-title</span> h1<span class="fu">.title</span> {</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">1.5</span><span class="dt">rem</span><span class="op">;</span> </span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>h2{</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">1.2</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-color</span><span class="ch">:</span><span class="fu">rgba(</span><span class="dv">128</span><span class="op">,</span> <span class="dv">170</span><span class="op">,</span> <span class="dv">156</span><span class="op">,</span> <span class="dv">0.48</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="fu">.future-idea-box</span> {</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border</span><span class="ch">:</span> <span class="dv">2</span><span class="dt">px</span> <span class="dv">solid</span> <span class="fu">var(</span><span class="va">--quarto-hl-header-color</span><span class="op">,</span> <span class="cn">#86bdab</span><span class="fu">)</span><span class="op">;</span> <span class="co">/* Uses Quarto header color variable or fallback */</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="kw">padding</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  <span class="kw">margin</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  <span class="kw">background</span><span class="ch">:</span> <span class="cn">#f9f9fc</span><span class="op">;</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a><span class="fu">.future-idea-title</span> {</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>  <span class="kw">font-weight</span><span class="ch">:</span> <span class="dv">bold</span><span class="op">;</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>  <span class="kw">color</span><span class="ch">:</span> <span class="fu">var(</span><span class="va">--quarto-hl-header-color</span><span class="op">,</span><span class="fu">rgb(</span><span class="dv">111</span><span class="op">,</span> <span class="dv">172</span><span class="op">,</span> <span class="dv">152</span><span class="fu">))</span><span class="op">;</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  <span class="kw">margin-bottom</span><span class="ch">:</span> <span class="dv">0.5</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>  <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">1.1</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="fu">.blue-text</span> {</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>  <span class="kw">color</span><span class="ch">:</span> <span class="fu">rgba(</span><span class="dv">70</span><span class="op">,</span> <span class="dv">70</span><span class="op">,</span> <span class="dv">194</span><span class="op">,</span> <span class="dv">1</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- CSS CHANGES --&gt;</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>All text in blue is written by intructor as the answer/explanation to the question.</span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mini-Project 1: Hypothesis Testing [30p]</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>The following R libraries are used:</span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a><span class="fu">### Proportion Test</span></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>A survey finds that 60% of users prefer using mobile apps over desktop websites for booking appointments. </span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>Your company believes the proportion is different in your city.</span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>Use the <span class="in">`PRJ2_MP1_PT.csv`</span> dataset to test whether the local preference differs from the national figure.</span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>I will use a one-sample z-test for proportions to test the hypothesis. </span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>Summarizing question's information: </span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>proportion of users who prefer apps over desktop websites is 60/100. </span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>I have data from my city. </span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Is the proportion I have in my city different from the 60% national figure?</span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>Mathamtically, that is: </span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a>H_0: p = 0.6</span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>vs </span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a>H_a: p \neq 0.6</span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a>Where $p$ is the proportion of users in my city who prefer apps over desktop websites.</span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a>Since significance level is not given, I will use the default of 0.05.</span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a>The test statistic is calculated as follows:</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>z = \frac{\hat{p} - p_0}{\sqrt{\frac{p_0(1 - p_0)}{n}}}</span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a>where $\hat{p}$ is the sample proportion, $p_0$ is the population proportion, and $n$ is the sample size.</span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a>The critical region for a two-tailed test at the 0.05 significance level is $|z| &gt; z_{\alpha/2} = 1.96$. </span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>Chapter 10, Example 10.9 and 10.10 would be helpful. </span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/PRJ2_MP1_PT.csv"</span>)</span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1)</span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a>Let's summarize the data to see how many of each we have: </span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span></span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Preference) <span class="sc">%&gt;%</span> </span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Preference) <span class="sc">%&gt;%</span> </span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb46-127"><a href="#cb46-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a>Add proportion to this: </span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span></span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Preference) <span class="sc">%&gt;%</span> </span>
<span id="cb46-137"><a href="#cb46-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Preference) <span class="sc">%&gt;%</span> </span>
<span id="cb46-138"><a href="#cb46-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb46-141"><a href="#cb46-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-142"><a href="#cb46-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-143"><a href="#cb46-143" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-144"><a href="#cb46-144" aria-hidden="true" tabindex="-1"></a>Already looks kind of close to 60%, but also not really depending on who you ask (52%) - so which is it? </span>
<span id="cb46-145"><a href="#cb46-145" aria-hidden="true" tabindex="-1"></a>You can either calculate the z value and compare it to the critical value, or use the <span class="in">`prop.test`</span> function in R.</span>
<span id="cb46-146"><a href="#cb46-146" aria-hidden="true" tabindex="-1"></a>This test takes in the number of successes (in this case, the number of users who prefer mobile apps), the total number of observations, the hypothesized proportion, and the alternative hypothesis's one tailed or two-tailedness.</span>
<span id="cb46-147"><a href="#cb46-147" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-148"><a href="#cb46-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-151"><a href="#cb46-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-152"><a href="#cb46-152" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(</span>
<span id="cb46-153"><a href="#cb46-153" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">sum</span>(df1<span class="sc">$</span>Preference <span class="sc">==</span> <span class="st">"Mobile App"</span>),</span>
<span id="cb46-154"><a href="#cb46-154" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">nrow</span>(df1),</span>
<span id="cb46-155"><a href="#cb46-155" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fl">0.60</span>,</span>
<span id="cb46-156"><a href="#cb46-156" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb46-157"><a href="#cb46-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">correct =</span> <span class="cn">FALSE</span> <span class="co"># optional </span></span>
<span id="cb46-158"><a href="#cb46-158" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-159"><a href="#cb46-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-160"><a href="#cb46-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-161"><a href="#cb46-161" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-162"><a href="#cb46-162" aria-hidden="true" tabindex="-1"></a>The p-value is quite small, so we reject the null hypothesis.</span>
<span id="cb46-163"><a href="#cb46-163" aria-hidden="true" tabindex="-1"></a>The null hypothesis was that the proportion of users who prefer mobile apps is 60%, and we found that it is significantly different from this value.</span>
<span id="cb46-164"><a href="#cb46-164" aria-hidden="true" tabindex="-1"></a>The 95% confidence interval for the proportion of users who prefer mobile apps is (0.42, 0.54), which does not include 0.6.</span>
<span id="cb46-165"><a href="#cb46-165" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-166"><a href="#cb46-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-167"><a href="#cb46-167" aria-hidden="true" tabindex="-1"></a><span class="fu">### Difference in Means  </span></span>
<span id="cb46-168"><a href="#cb46-168" aria-hidden="true" tabindex="-1"></a>Two customer service strategies were implemented in your company.</span>
<span id="cb46-169"><a href="#cb46-169" aria-hidden="true" tabindex="-1"></a>The customer satisfaction scores are collected and saved in <span class="in">`PRJ2_MP1_DM.csv`</span>. </span>
<span id="cb46-170"><a href="#cb46-170" aria-hidden="true" tabindex="-1"></a>Test whether the mean satisfaction differs significantly between the two strategies.</span>
<span id="cb46-171"><a href="#cb46-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-172"><a href="#cb46-172" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-173"><a href="#cb46-173" aria-hidden="true" tabindex="-1"></a>I will use a two-sample t-test to test the difference in means between the two customer service strategies.</span>
<span id="cb46-174"><a href="#cb46-174" aria-hidden="true" tabindex="-1"></a>The hypotheses are as follows:</span>
<span id="cb46-175"><a href="#cb46-175" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-176"><a href="#cb46-176" aria-hidden="true" tabindex="-1"></a>H_0: \mu_1 - \mu_2 = 0</span>
<span id="cb46-177"><a href="#cb46-177" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-178"><a href="#cb46-178" aria-hidden="true" tabindex="-1"></a>vs</span>
<span id="cb46-179"><a href="#cb46-179" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-180"><a href="#cb46-180" aria-hidden="true" tabindex="-1"></a>H_a: \mu_1 - \mu_2 \neq 0</span>
<span id="cb46-181"><a href="#cb46-181" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-182"><a href="#cb46-182" aria-hidden="true" tabindex="-1"></a>Where $\mu_1$ is the mean satisfaction score for strategy 1 and $\mu_2$ is the mean satisfaction score for strategy 2.</span>
<span id="cb46-183"><a href="#cb46-183" aria-hidden="true" tabindex="-1"></a>The significance level is not given, so I will use the default of 0.05.</span>
<span id="cb46-184"><a href="#cb46-184" aria-hidden="true" tabindex="-1"></a>The test statistic is calculated based on chapter 10.5 of Walpole book.</span>
<span id="cb46-185"><a href="#cb46-185" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-186"><a href="#cb46-186" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-187"><a href="#cb46-187" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-188"><a href="#cb46-188" aria-hidden="true" tabindex="-1"></a>Let's first look at the data and see the difference between the two strategies.</span>
<span id="cb46-189"><a href="#cb46-189" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-190"><a href="#cb46-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-193"><a href="#cb46-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-194"><a href="#cb46-194" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/PRJ2_MP1_DM.csv"</span>)</span>
<span id="cb46-195"><a href="#cb46-195" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df2)</span>
<span id="cb46-196"><a href="#cb46-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-197"><a href="#cb46-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-200"><a href="#cb46-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-201"><a href="#cb46-201" aria-hidden="true" tabindex="-1"></a>df2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb46-202"><a href="#cb46-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">stg1_mean =</span> <span class="fu">mean</span>(strategy1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-203"><a href="#cb46-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">stg2_mean =</span> <span class="fu">mean</span>(strategy2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-204"><a href="#cb46-204" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-205"><a href="#cb46-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-206"><a href="#cb46-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-207"><a href="#cb46-207" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-208"><a href="#cb46-208" aria-hidden="true" tabindex="-1"></a>It seems that the mean satisfaction score for strategy 1 is much lower than for strategy 2. But, is it significantly different?</span>
<span id="cb46-209"><a href="#cb46-209" aria-hidden="true" tabindex="-1"></a>Let's see the tests for the cases where: </span>
<span id="cb46-210"><a href="#cb46-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-211"><a href="#cb46-211" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Variances are known or unknown and equal</span>
<span id="cb46-212"><a href="#cb46-212" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Variances are unknown and unequal</span>
<span id="cb46-213"><a href="#cb46-213" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-214"><a href="#cb46-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-217"><a href="#cb46-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-218"><a href="#cb46-218" aria-hidden="true" tabindex="-1"></a><span class="co"># Variances are known or unknown and equal</span></span>
<span id="cb46-219"><a href="#cb46-219" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df2<span class="sc">$</span>strategy1, df2<span class="sc">$</span>strategy2, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-220"><a href="#cb46-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>     </span>
<span id="cb46-221"><a href="#cb46-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-222"><a href="#cb46-222" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb46-223"><a href="#cb46-223" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-224"><a href="#cb46-224" aria-hidden="true" tabindex="-1"></a>Since the p-value is less than 0.05, we reject the null hypothesis and conclude that there is a significant difference in mean satisfaction scores between the two strategies.</span>
<span id="cb46-225"><a href="#cb46-225" aria-hidden="true" tabindex="-1"></a>That is, $\mu_1 - \mu_2 \neq 0$.</span>
<span id="cb46-226"><a href="#cb46-226" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-227"><a href="#cb46-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-228"><a href="#cb46-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-231"><a href="#cb46-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-232"><a href="#cb46-232" aria-hidden="true" tabindex="-1"></a><span class="co"># Variances are unknown and unequal</span></span>
<span id="cb46-233"><a href="#cb46-233" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df2<span class="sc">$</span>strategy1, df2<span class="sc">$</span>strategy2, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-234"><a href="#cb46-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-235"><a href="#cb46-235" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-236"><a href="#cb46-236" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-237"><a href="#cb46-237" aria-hidden="true" tabindex="-1"></a>Similarly, if variances were unknown and unequal, we would still reject the null hypothesis.</span>
<span id="cb46-238"><a href="#cb46-238" aria-hidden="true" tabindex="-1"></a>Let's see if we can say something about the variances: </span>
<span id="cb46-239"><a href="#cb46-239" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-240"><a href="#cb46-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-243"><a href="#cb46-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-244"><a href="#cb46-244" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(df2<span class="sc">$</span>strategy1, df2<span class="sc">$</span>strategy2)</span>
<span id="cb46-245"><a href="#cb46-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-246"><a href="#cb46-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-247"><a href="#cb46-247" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb46-248"><a href="#cb46-248" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-249"><a href="#cb46-249" aria-hidden="true" tabindex="-1"></a>Looks like variances are not equal, so we should use the second t-test result.</span>
<span id="cb46-250"><a href="#cb46-250" aria-hidden="true" tabindex="-1"></a>Another way to check means (and variance) between the two groups is using visualizations (but much less formal):</span>
<span id="cb46-251"><a href="#cb46-251" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-252"><a href="#cb46-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-255"><a href="#cb46-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-256"><a href="#cb46-256" aria-hidden="true" tabindex="-1"></a>df2 <span class="sc">%&gt;%</span></span>
<span id="cb46-257"><a href="#cb46-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb46-258"><a href="#cb46-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(strategy1, strategy2), </span>
<span id="cb46-259"><a href="#cb46-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"strategyName"</span>, </span>
<span id="cb46-260"><a href="#cb46-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"strategySatisfaction"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-261"><a href="#cb46-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>strategyName, <span class="at">y=</span>strategySatisfaction)) <span class="sc">+</span> </span>
<span id="cb46-262"><a href="#cb46-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb46-263"><a href="#cb46-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Strategy"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Satisfaction"</span>) <span class="sc">+</span> </span>
<span id="cb46-264"><a href="#cb46-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb46-265"><a href="#cb46-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-266"><a href="#cb46-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-267"><a href="#cb46-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-268"><a href="#cb46-268" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variance Test </span></span>
<span id="cb46-269"><a href="#cb46-269" aria-hidden="true" tabindex="-1"></a>You are analyzing consistency in delivery times between two delivery partners.</span>
<span id="cb46-270"><a href="#cb46-270" aria-hidden="true" tabindex="-1"></a>The dataset is available in <span class="in">`PRJ2_MP1_VT.csv`</span>.</span>
<span id="cb46-271"><a href="#cb46-271" aria-hidden="true" tabindex="-1"></a>Test whether their delivery time variances are equal.</span>
<span id="cb46-272"><a href="#cb46-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-273"><a href="#cb46-273" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-274"><a href="#cb46-274" aria-hidden="true" tabindex="-1"></a>All tests are based on Walpole's book, chapter 10.10. </span>
<span id="cb46-275"><a href="#cb46-275" aria-hidden="true" tabindex="-1"></a>We want to test the following hypotheses:</span>
<span id="cb46-276"><a href="#cb46-276" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-277"><a href="#cb46-277" aria-hidden="true" tabindex="-1"></a>H_0: \sigma_1^2 = \sigma_2^2</span>
<span id="cb46-278"><a href="#cb46-278" aria-hidden="true" tabindex="-1"></a>$$          </span>
<span id="cb46-279"><a href="#cb46-279" aria-hidden="true" tabindex="-1"></a>vs</span>
<span id="cb46-280"><a href="#cb46-280" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-281"><a href="#cb46-281" aria-hidden="true" tabindex="-1"></a>H_a: \sigma_1^2 \neq \sigma_2^2</span>
<span id="cb46-282"><a href="#cb46-282" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-283"><a href="#cb46-283" aria-hidden="true" tabindex="-1"></a>Where $\sigma_1^2$ is the variance of delivery times for partner 1 and $\sigma_2^2$ is the variance for partner 2.  </span>
<span id="cb46-284"><a href="#cb46-284" aria-hidden="true" tabindex="-1"></a>We do have to assume the two samples are independent.</span>
<span id="cb46-285"><a href="#cb46-285" aria-hidden="true" tabindex="-1"></a>Since the significance level is not given, I will use the default of 0.05.</span>
<span id="cb46-286"><a href="#cb46-286" aria-hidden="true" tabindex="-1"></a>Look at example 10.13 for more details.</span>
<span id="cb46-287"><a href="#cb46-287" aria-hidden="true" tabindex="-1"></a>Let's look at the data first and check the variances:</span>
<span id="cb46-288"><a href="#cb46-288" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-289"><a href="#cb46-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-292"><a href="#cb46-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-293"><a href="#cb46-293" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/PRJ2_MP1_VT.csv"</span>)</span>
<span id="cb46-294"><a href="#cb46-294" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df3)</span>
<span id="cb46-295"><a href="#cb46-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>     </span>
<span id="cb46-296"><a href="#cb46-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-299"><a href="#cb46-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-300"><a href="#cb46-300" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(partner) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">variance =</span> <span class="fu">var</span>(delivery_time))</span>
<span id="cb46-301"><a href="#cb46-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-302"><a href="#cb46-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-303"><a href="#cb46-303" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-304"><a href="#cb46-304" aria-hidden="true" tabindex="-1"></a>So, we need to separate the data by partner and then use the <span class="in">`var.test`</span> function to test the variances.</span>
<span id="cb46-305"><a href="#cb46-305" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-306"><a href="#cb46-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-309"><a href="#cb46-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-310"><a href="#cb46-310" aria-hidden="true" tabindex="-1"></a>partner1 <span class="ot">&lt;-</span> df3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(partner <span class="sc">==</span> <span class="st">"Partner1"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(delivery_time)</span>
<span id="cb46-311"><a href="#cb46-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-312"><a href="#cb46-312" aria-hidden="true" tabindex="-1"></a>partner2 <span class="ot">&lt;-</span> df3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(partner <span class="sc">==</span> <span class="st">"Partner2"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(delivery_time)</span>
<span id="cb46-313"><a href="#cb46-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-314"><a href="#cb46-314" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(partner1, partner2)</span>
<span id="cb46-315"><a href="#cb46-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-316"><a href="#cb46-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-317"><a href="#cb46-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-318"><a href="#cb46-318" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-319"><a href="#cb46-319" aria-hidden="true" tabindex="-1"></a>The null hypothesis is that the variances are equal, and the alternative hypothesis is that they are not equal.</span>
<span id="cb46-320"><a href="#cb46-320" aria-hidden="true" tabindex="-1"></a>The p-value is 0.0001, which is less than the significance level of 0.05.</span>
<span id="cb46-321"><a href="#cb46-321" aria-hidden="true" tabindex="-1"></a>Therefore, we reject the null hypothesis and conclude that the variances of delivery times between the two partners are significantly different.</span>
<span id="cb46-322"><a href="#cb46-322" aria-hidden="true" tabindex="-1"></a>This means that one partner is more consistent than the other.</span>
<span id="cb46-323"><a href="#cb46-323" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-324"><a href="#cb46-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-325"><a href="#cb46-325" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb46-326"><a href="#cb46-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-327"><a href="#cb46-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mini-Project 2 [30p]</span></span>
<span id="cb46-328"><a href="#cb46-328" aria-hidden="true" tabindex="-1"></a>You work for a coffee company as a data scientist.</span>
<span id="cb46-329"><a href="#cb46-329" aria-hidden="true" tabindex="-1"></a>The company wants to find out which roasting level leads to the highest average rating from customers.</span>
<span id="cb46-330"><a href="#cb46-330" aria-hidden="true" tabindex="-1"></a>You conduct taste tests and collect scores from 50 random customers for each roast level.</span>
<span id="cb46-331"><a href="#cb46-331" aria-hidden="true" tabindex="-1"></a>The results of this is collected in the <span class="in">`PRJ2_MP2.csv`</span> file.</span>
<span id="cb46-332"><a href="#cb46-332" aria-hidden="true" tabindex="-1"></a>Write clearly the statistical question you want to answer, your methodology in answering the question and your results. </span>
<span id="cb46-333"><a href="#cb46-333" aria-hidden="true" tabindex="-1"></a>If you find that there are differences between roast levels, determine which groups differ. </span>
<span id="cb46-334"><a href="#cb46-334" aria-hidden="true" tabindex="-1"></a>Finally, complete your analysis by discussing what the findings mean practically and what you suggest to your company to do next.</span>
<span id="cb46-335"><a href="#cb46-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-336"><a href="#cb46-336" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-337"><a href="#cb46-337" aria-hidden="true" tabindex="-1"></a>The statistical question we want to answer is: "Which roasting level leads to the highest average rating from customers?"</span>
<span id="cb46-338"><a href="#cb46-338" aria-hidden="true" tabindex="-1"></a>We will use ANOVA to test whether there are significant differences in ratings between the different roast levels.</span>
<span id="cb46-339"><a href="#cb46-339" aria-hidden="true" tabindex="-1"></a>The null hypothesis is that there are no differences in ratings between the roast levels, while the alternative hypothesis is that at least one roast level has a different mean rating.</span>
<span id="cb46-340"><a href="#cb46-340" aria-hidden="true" tabindex="-1"></a>We will use a significance level of 0.05.</span>
<span id="cb46-341"><a href="#cb46-341" aria-hidden="true" tabindex="-1"></a>If we find significant differences, we will use post-hoc tests to determine which roast levels differ from each other.</span>
<span id="cb46-342"><a href="#cb46-342" aria-hidden="true" tabindex="-1"></a>Finally, we will interpret the results and provide practical recommendations to the company.</span>
<span id="cb46-343"><a href="#cb46-343" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-344"><a href="#cb46-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-347"><a href="#cb46-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-348"><a href="#cb46-348" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/PRJ2_MP2.csv"</span>)</span>
<span id="cb46-349"><a href="#cb46-349" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df4)</span>
<span id="cb46-350"><a href="#cb46-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-351"><a href="#cb46-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-354"><a href="#cb46-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-355"><a href="#cb46-355" aria-hidden="true" tabindex="-1"></a>df4 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Roast) <span class="sc">%&gt;%</span> </span>
<span id="cb46-356"><a href="#cb46-356" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb46-357"><a href="#cb46-357" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean_rating =</span> <span class="fu">mean</span>(Score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb46-358"><a href="#cb46-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-359"><a href="#cb46-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-360"><a href="#cb46-360" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-361"><a href="#cb46-361" aria-hidden="true" tabindex="-1"></a>Looks like medium has the highest mean rating, but we need to test if this is statistically significant.</span>
<span id="cb46-362"><a href="#cb46-362" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-363"><a href="#cb46-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-366"><a href="#cb46-366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-367"><a href="#cb46-367" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Score <span class="sc">~</span> <span class="fu">as.factor</span>(Roast), <span class="at">data =</span> df4)</span>
<span id="cb46-368"><a href="#cb46-368" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span>
<span id="cb46-369"><a href="#cb46-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-370"><a href="#cb46-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-371"><a href="#cb46-371" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-372"><a href="#cb46-372" aria-hidden="true" tabindex="-1"></a>There is a difference in means between the roast levels, as the p-value is less than 0.05.</span>
<span id="cb46-373"><a href="#cb46-373" aria-hidden="true" tabindex="-1"></a>Therefore, we know that roast level matters!</span>
<span id="cb46-374"><a href="#cb46-374" aria-hidden="true" tabindex="-1"></a>Now, we need to perform post-hoc tests to determine which roast levels differ from each other.</span>
<span id="cb46-375"><a href="#cb46-375" aria-hidden="true" tabindex="-1"></a>We will use Tukey's HSD test for this purpose.</span>
<span id="cb46-376"><a href="#cb46-376" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-377"><a href="#cb46-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-380"><a href="#cb46-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-381"><a href="#cb46-381" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb46-382"><a href="#cb46-382" aria-hidden="true" tabindex="-1"></a>tukey_result    </span>
<span id="cb46-383"><a href="#cb46-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-384"><a href="#cb46-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-385"><a href="#cb46-385" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-386"><a href="#cb46-386" aria-hidden="true" tabindex="-1"></a>Another way to do this: </span>
<span id="cb46-387"><a href="#cb46-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-388"><a href="#cb46-388" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Separate the data by roast level and create the covariates (go to your notes and see Indicator variables)</span>
<span id="cb46-389"><a href="#cb46-389" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-390"><a href="#cb46-390" aria-hidden="true" tabindex="-1"></a>y = \mu + \tau_1 (I(L) - I(D)) + \tau_2 (I(M) - I(D)) + \epsilon</span>
<span id="cb46-391"><a href="#cb46-391" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-392"><a href="#cb46-392" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Make pairwise comparisons between the roast levels, creating a new value from the other two (factor levels)</span>
<span id="cb46-393"><a href="#cb46-393" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Use a linear model </span>
<span id="cb46-394"><a href="#cb46-394" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Use tukey's and bonferroni </span>
<span id="cb46-395"><a href="#cb46-395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-396"><a href="#cb46-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-399"><a href="#cb46-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-400"><a href="#cb46-400" aria-hidden="true" tabindex="-1"></a>df4<span class="sc">$</span>Roast <span class="ot">&lt;-</span> <span class="fu">factor</span>(df4<span class="sc">$</span>Roast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Dark"</span>, <span class="st">"Light"</span>, <span class="st">"Medium"</span>))</span>
<span id="cb46-401"><a href="#cb46-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-402"><a href="#cb46-402" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up custom contrasts: </span></span>
<span id="cb46-403"><a href="#cb46-403" aria-hidden="true" tabindex="-1"></a><span class="co"># First column: Light vs Dark</span></span>
<span id="cb46-404"><a href="#cb46-404" aria-hidden="true" tabindex="-1"></a><span class="co"># Second column: Medium vs Dark</span></span>
<span id="cb46-405"><a href="#cb46-405" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df4<span class="sc">$</span>Roast) <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb46-406"><a href="#cb46-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb46-407"><a href="#cb46-407" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">1</span>,  <span class="dv">0</span>,  <span class="co"># Dark</span></span>
<span id="cb46-408"><a href="#cb46-408" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="co"># Light</span></span>
<span id="cb46-409"><a href="#cb46-409" aria-hidden="true" tabindex="-1"></a>     <span class="dv">0</span>,  <span class="dv">1</span>   <span class="co"># Medium</span></span>
<span id="cb46-410"><a href="#cb46-410" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-411"><a href="#cb46-411" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb46-412"><a href="#cb46-412" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-413"><a href="#cb46-413" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(df4<span class="sc">$</span>Roast)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Light_vs_Dark"</span>, <span class="st">"Medium_vs_Dark"</span>)</span>
<span id="cb46-414"><a href="#cb46-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-415"><a href="#cb46-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-416"><a href="#cb46-416" aria-hidden="true" tabindex="-1"></a>contrast_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Score <span class="sc">~</span> Roast, <span class="at">data =</span> df4)</span>
<span id="cb46-417"><a href="#cb46-417" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_model)</span>
<span id="cb46-418"><a href="#cb46-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-419"><a href="#cb46-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-420"><a href="#cb46-420" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-421"><a href="#cb46-421" aria-hidden="true" tabindex="-1"></a>From the results, we have: $\mu = 6.482$, $\tau_1 = 2.558$, and $\tau_2 = -0.490$.</span>
<span id="cb46-422"><a href="#cb46-422" aria-hidden="true" tabindex="-1"></a>We need to calculate the t-statistic: </span>
<span id="cb46-423"><a href="#cb46-423" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-424"><a href="#cb46-424" aria-hidden="true" tabindex="-1"></a>t = \frac{\hat{\tau}_i - \hat{\tau}_j}{\sqrt{2\frac{\sigma^2}{n}}}</span>
<span id="cb46-425"><a href="#cb46-425" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-426"><a href="#cb46-426" aria-hidden="true" tabindex="-1"></a>Critical values for multiple comparisons:</span>
<span id="cb46-427"><a href="#cb46-427" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-428"><a href="#cb46-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-429"><a href="#cb46-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-432"><a href="#cb46-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-433"><a href="#cb46-433" aria-hidden="true" tabindex="-1"></a>sigma_sq <span class="ot">&lt;-</span> <span class="fl">0.5037</span> <span class="co"># from contrast_model summary </span></span>
<span id="cb46-434"><a href="#cb46-434" aria-hidden="true" tabindex="-1"></a>denom <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> sigma_sq <span class="sc">/</span> <span class="dv">50</span>) <span class="co"># 50 is the number of observations per group</span></span>
<span id="cb46-435"><a href="#cb46-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-436"><a href="#cb46-436" aria-hidden="true" tabindex="-1"></a>tau_light_vs_medium <span class="ot">&lt;-</span> <span class="sc">-</span>(<span class="fl">2.55820</span> <span class="sc">-</span> <span class="fl">0.49040</span>)</span>
<span id="cb46-437"><a href="#cb46-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-438"><a href="#cb46-438" aria-hidden="true" tabindex="-1"></a>t_light_vs_dark <span class="ot">&lt;-</span> (<span class="fl">2.55820</span>) <span class="sc">/</span> denom</span>
<span id="cb46-439"><a href="#cb46-439" aria-hidden="true" tabindex="-1"></a>t_medium_vs_dark <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fl">0.49040</span>) <span class="sc">/</span> denom</span>
<span id="cb46-440"><a href="#cb46-440" aria-hidden="true" tabindex="-1"></a>t_light_vs_medium <span class="ot">&lt;-</span> tau_light_vs_medium <span class="sc">/</span> denom </span>
<span id="cb46-441"><a href="#cb46-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-442"><a href="#cb46-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-443"><a href="#cb46-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-444"><a href="#cb46-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-445"><a href="#cb46-445" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-446"><a href="#cb46-446" aria-hidden="true" tabindex="-1"></a>Now compare these with bonferroni and tukey's critical values:</span>
<span id="cb46-447"><a href="#cb46-447" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-448"><a href="#cb46-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-451"><a href="#cb46-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-452"><a href="#cb46-452" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni critical value</span></span>
<span id="cb46-453"><a href="#cb46-453" aria-hidden="true" tabindex="-1"></a>bonferroni_critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">147</span>)</span>
<span id="cb46-454"><a href="#cb46-454" aria-hidden="true" tabindex="-1"></a><span class="co"># 147 is the number of observations - 3 (number of groups)</span></span>
<span id="cb46-455"><a href="#cb46-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-456"><a href="#cb46-456" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey's critical value</span></span>
<span id="cb46-457"><a href="#cb46-457" aria-hidden="true" tabindex="-1"></a>tukey_critical <span class="ot">&lt;-</span> <span class="fu">qtukey</span>(<span class="fl">0.95</span>, <span class="dv">3</span>, <span class="dv">147</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb46-458"><a href="#cb46-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-459"><a href="#cb46-459" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"bonferonni"</span>, <span class="fu">round</span>(bonferroni_critical,<span class="dv">3</span>), <span class="st">" Tukey"</span>, <span class="fu">round</span>(tukey_critical,<span class="dv">3</span>)))</span>
<span id="cb46-460"><a href="#cb46-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-461"><a href="#cb46-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-464"><a href="#cb46-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-465"><a href="#cb46-465" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(t_light_vs_dark <span class="sc">&gt;</span> bonferroni_critical, <span class="st">"and "</span>, t_light_vs_dark <span class="sc">&gt;</span> tukey_critical))</span>
<span id="cb46-466"><a href="#cb46-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-467"><a href="#cb46-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-468"><a href="#cb46-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-471"><a href="#cb46-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-472"><a href="#cb46-472" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(t_medium_vs_dark <span class="sc">&gt;</span> bonferroni_critical, <span class="st">"and "</span>, t_medium_vs_dark <span class="sc">&gt;</span> tukey_critical))</span>
<span id="cb46-473"><a href="#cb46-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-474"><a href="#cb46-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-475"><a href="#cb46-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-478"><a href="#cb46-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-479"><a href="#cb46-479" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(t_light_vs_medium <span class="sc">&gt;</span> bonferroni_critical,<span class="st">"and "</span>, t_light_vs_medium <span class="sc">&gt;</span> tukey_critical))    </span>
<span id="cb46-480"><a href="#cb46-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-481"><a href="#cb46-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-482"><a href="#cb46-482" aria-hidden="true" tabindex="-1"></a>:::{.blue-text}</span>
<span id="cb46-483"><a href="#cb46-483" aria-hidden="true" tabindex="-1"></a>Since if $t_{ij} &gt; t_{crit}$, then we can reject the null hypothesis that the two means are equal.</span>
<span id="cb46-484"><a href="#cb46-484" aria-hidden="true" tabindex="-1"></a>Therefore, only ones different are light vs dark. </span>
<span id="cb46-485"><a href="#cb46-485" aria-hidden="true" tabindex="-1"></a>So, $\mu_{light} \neq \mu_{dark}$.</span>
<span id="cb46-486"><a href="#cb46-486" aria-hidden="true" tabindex="-1"></a>Since these two groups are different, maybe the company should focus on improving the dark roast to match the light roast's quality so the dark roast rating isn't so low.</span>
<span id="cb46-487"><a href="#cb46-487" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-488"><a href="#cb46-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-489"><a href="#cb46-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-490"><a href="#cb46-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-491"><a href="#cb46-491" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mini-Project 3: Linear Regression Analysis [40p]</span></span>
<span id="cb46-492"><a href="#cb46-492" aria-hidden="true" tabindex="-1"></a>Download the <span class="in">`PRJ2_MP3_airbnb.csv`</span> dataset either from LEARN or from <span class="co">[</span><span class="ot">Kaggle</span><span class="co">](https://www.kaggle.com/datasets/aroramahima1/amsterdam-airbnb-prices-dataset/data)</span>.</span>
<span id="cb46-493"><a href="#cb46-493" aria-hidden="true" tabindex="-1"></a>This dataset has 33 columns and $7,833$ rows of Airbnb listings from Amsterdam. </span>
<span id="cb46-494"><a href="#cb46-494" aria-hidden="true" tabindex="-1"></a>Use this dataset to predict the price of Airbnb listings in Amsterdam using linear regression. </span>
<span id="cb46-495"><a href="#cb46-495" aria-hidden="true" tabindex="-1"></a>Make sure you clean and pre-process the dataset, include exploratory data analysis, check regression assumptions, and set aside 20% of the dataset as your test data. </span>
<span id="cb46-496"><a href="#cb46-496" aria-hidden="true" tabindex="-1"></a>You do not need to include all the variables (columns) in the model, but your final prediction accuracy (as long as overfitting is not an issue) will be graded. </span>
<span id="cb46-497"><a href="#cb46-497" aria-hidden="true" tabindex="-1"></a>Include a correlation matrix with the model variables before you do the modeling. </span>
<span id="cb46-498"><a href="#cb46-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-499"><a href="#cb46-499" aria-hidden="true" tabindex="-1"></a>Make sure you can justify any variable that is included in your model (using literature or data). </span>
<span id="cb46-500"><a href="#cb46-500" aria-hidden="true" tabindex="-1"></a>Check for multi-collinearity and normality of residuals. </span>
<span id="cb46-501"><a href="#cb46-501" aria-hidden="true" tabindex="-1"></a>Most importantly, interpret the regression results: </span>
<span id="cb46-502"><a href="#cb46-502" aria-hidden="true" tabindex="-1"></a>Which predictors are significant?</span>
<span id="cb46-503"><a href="#cb46-503" aria-hidden="true" tabindex="-1"></a>What does the coefficient of each mean in real-world terms?</span>
<span id="cb46-504"><a href="#cb46-504" aria-hidden="true" tabindex="-1"></a>How good is your model? </span>
<span id="cb46-505"><a href="#cb46-505" aria-hidden="true" tabindex="-1"></a>Be sure to explain your findings in simple, real-world terms.</span>
<span id="cb46-506"><a href="#cb46-506" aria-hidden="true" tabindex="-1"></a>For example: ``Each additional bedroom increases the price by $85 on average, holding other variables constant.''</span>
<span id="cb46-507"><a href="#cb46-507" aria-hidden="true" tabindex="-1"></a>Write your regression model's mathematical formula and introduce the notation in a Table.  </span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>